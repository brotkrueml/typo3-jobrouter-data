<html
    xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
    data-namespace-typo3-fluid="true"
>
    <h2>{f:translate(key:"LLL:EXT:jobrouter_data/Resources/Private/Language/Report.xlf:synchronisations")}</h2>

    <p>
        Last Synchronisation:
        <f:if condition="{lastSyncDate}">
            <f:then>
                {lastSyncDate -> f:format.date(format: settings.dateTimeFormat)}
            </f:then>
            <f:else>
                <f:translate key="LLL:EXT:jobrouter_data/Resources/Private/Language/Report.xlf:never_run"/>
            </f:else>
        </f:if>
    </p>

    <f:render section="synchronisations" arguments="{_all}"/>

    <f:section name="synchronisations">
        <table class="table table-striped table-hover table-vertical-top">
            <tbody>
                <f:for each="{syncTablesByType}" key="type" as="tables">
                    <tr>
                        <td class="info col-xs-6">
                            <f:translate key="LLL:EXT:jobrouter_data/Resources/Private/Language/Report.xlf:active_sync_tables.{type}"/>
                        </td>
                        <td class="info col-xs-6">{tables.totalActive}</td>
                    </tr>
                    <f:if condition="{tables.erroneous}">
                        <td class="danger col-xs-6">
                            &nbsp;&nbsp;&nbsp; <f:translate key="LLL:EXT:jobrouter_data/Resources/Private/Language/Report.xlf:with_errors"/>
                        </td>
                        <td class="danger col-xs-6">
                            <f:for each="{tables.erroneous}" as="table">
                                {table.name} (<span title="{table.lastSyncError}">{table.lastSyncError -> f:format.crop(maxCharacters: 100)}</span>)<br>
                            </f:for>
                        </td>
                    </f:if>
                </f:for>
            </tbody>
        </table>
    </f:section>

</html>
